[95m
[95mStarting discovery in 88 files.[0m
[91m[-] Discovery in /workspaces/opentofu-lab-automation/tests/Get-WindowsJobArtifacts.Tests.ps1 failed with:[0m
[91mSystem.Management.Automation.ParseException: At /workspaces/opentofu-lab-automation/tests/Get-WindowsJobArtifacts.Tests.ps1:102 char:1
[91m+ }
[91m+ ~
[91mUnexpected token '}' in expression or statement.
[91m   at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
[91m   at Invoke-File(Closure, FunctionContext)
[91m   at System.Management.Automation.PSScriptCmdlet.RunClause(Action`1 clause, Object dollarUnderbar, Object inputToProcess)
[91m   at System.Management.Automation.CommandProcessorBase.Complete()
[91mat <ScriptBlock>, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 3090
[91mat Invoke-File, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 3099
[91mat Invoke-BlockContainer, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 3008
[91mat Discover-Test, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 1480
[91mat Invoke-Test, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 2474
[91mat Invoke-Pester<End>, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 4960
[91mat <ScriptBlock>, <No file>: line 1[0m
[91m[-] Discovery in /workspaces/opentofu-lab-automation/tests/examples/Install-Go.Modern.Tests.ps1 failed with:[0m
[91mSystem.InvalidOperationException: The Export-ModuleMember cmdlet can only be called from inside a module.
[91m   at System.Management.Automation.MshCommandRuntime.ThrowTerminatingError(ErrorRecord errorRecord)
[91mat <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/helpers/TestTemplates.ps1: line 346
[91mat <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/examples/Install-Go.Modern.Tests.ps1: line 12
[91mat <ScriptBlock>, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 3090
[91mat Invoke-File, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 3099
[91mat Invoke-BlockContainer, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 3008
[91mat Discover-Test, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 1480
[91mat Invoke-Test, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 2474
[91mat Invoke-Pester<End>, /home/codespace/.local/share/powershell/Modules/Pester/5.7.1/Pester.psm1: line 4960
[91mat <ScriptBlock>, <No file>: line 1[0m
[95mDiscovery found 698 tests in 3.81s.[0m
[95mRunning tests.[0m
[-] 0000_Cleanup-Files Tests.Script Structure Validation.should have valid PowerShell syntax 99ms (73ms|26ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0000_Cleanup-Files.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0000_Cleanup-Files.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1' to exist, but it did not exist.
[-] 0000_Cleanup-Files Tests.Parameter Validation.should accept Config parameter 31ms (28ms|2ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0000_Cleanup-Files.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0000_Cleanup-Files.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0000_Cleanup-Files.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[-] 0001_Reset-Git Tests.Script Structure Validation.should have valid PowerShell syntax 7ms (5ms|1ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0001_Reset-Git.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0001_Reset-Git.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0001_Reset-Git.ps1' to exist, but it did not exist.
[-] 0001_Reset-Git Tests.Parameter Validation.should accept Config parameter 63ms (56ms|7ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0001_Reset-Git.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0001_Reset-Git.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0001_Reset-Git.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0001_Reset-Git.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[-] 0002_Setup-Directories Tests.Script Structure Validation.should have valid PowerShell syntax 20ms (16ms|4ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0002_Setup-Directories.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0002_Setup-Directories.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0002_Setup-Directories.ps1' to exist, but it did not exist.
[-] 0002_Setup-Directories Tests.Parameter Validation.should accept Config parameter 33ms (29ms|4ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0002_Setup-Directories.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0002_Setup-Directories.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0002_Setup-Directories.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0002_Setup-Directories.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[32m[+] /workspaces/opentofu-lab-automation/tests/0006_Install-ValidationTools.Tests.ps1[0m[90m 345ms (14ms|298ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0006_Install-ValidationTools.Tests.ps1[0m[90m 345ms (14ms|298ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0007_Install-Go.Tests.ps1[0m[90m 122ms (8ms|98ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0007_Install-Go.Tests.ps1[0m[90m 122ms (8ms|98ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0008_Install-OpenTofu.Tests.ps1[0m[90m 257ms (13ms|219ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0008_Install-OpenTofu.Tests.ps1[0m[90m 257ms (13ms|219ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0009_Initialize-OpenTofu.Tests.ps1[0m[90m 78ms (6ms|53ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0009_Initialize-OpenTofu.Tests.ps1[0m[90m 78ms (6ms|53ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0010_Prepare-HyperVProvider.Tests.ps1[0m[90m 159ms (5ms|97ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0010_Prepare-HyperVProvider.Tests.ps1[0m[90m 159ms (5ms|97ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0100_Enable-WinRM.Tests.ps1[0m[90m 194ms (12ms|155ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0100_Enable-WinRM.Tests.ps1[0m[90m 194ms (12ms|155ms)[0m
[-] 0101_Enable-RemoteDesktop Tests.Script Structure Validation.should have valid PowerShell syntax 10ms (9ms|2ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0101_Enable-RemoteDesktop.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0101_Enable-RemoteDesktop.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0101_Enable-RemoteDesktop.ps1' to exist, but it did not exist.
[-] 0101_Enable-RemoteDesktop Tests.Parameter Validation.should accept Config parameter 32ms (28ms|4ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0101_Enable-RemoteDesktop.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0101_Enable-RemoteDesktop.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0101_Enable-RemoteDesktop.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0101_Enable-RemoteDesktop.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[-] 0102_Configure-Firewall Tests.Script Structure Validation.should have valid PowerShell syntax 19ms (15ms|4ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0102_Configure-Firewall.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0102_Configure-Firewall.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0102_Configure-Firewall.ps1' to exist, but it did not exist.
[-] 0102_Configure-Firewall Tests.Parameter Validation.should accept Config parameter 27ms (24ms|4ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0102_Configure-Firewall.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0102_Configure-Firewall.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0102_Configure-Firewall.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0102_Configure-Firewall.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[32m[+] /workspaces/opentofu-lab-automation/tests/0103_Change-ComputerName.Tests.ps1[0m[90m 149ms (8ms|116ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0103_Change-ComputerName.Tests.ps1[0m[90m 149ms (8ms|116ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0104_Install-CA.Tests.ps1[0m[90m 326ms (24ms|257ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0104_Install-CA.Tests.ps1[0m[90m 326ms (24ms|257ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0105_Install-HyperV.Tests.ps1[0m[90m 269ms (22ms|220ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0105_Install-HyperV.Tests.ps1[0m[90m 269ms (22ms|220ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0106_Install-WAC.Tests.ps1[0m[90m 387ms (183ms|176ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0106_Install-WAC.Tests.ps1[0m[90m 387ms (183ms|176ms)[0m
[-] 0111_Disable-TCPIP6 Tests.Script Structure Validation.should have valid PowerShell syntax 19ms (14ms|4ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0111_Disable-TCPIP6.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0111_Disable-TCPIP6.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0111_Disable-TCPIP6.ps1' to exist, but it did not exist.
[-] 0111_Disable-TCPIP6 Tests.Parameter Validation.should accept Config parameter 27ms (24ms|3ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0111_Disable-TCPIP6.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0111_Disable-TCPIP6.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0111_Disable-TCPIP6.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0111_Disable-TCPIP6.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[-] 0112_Enable-PXE Tests.Script Structure Validation.should have valid PowerShell syntax 36ms (25ms|11ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0112_Enable-PXE.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0112_Enable-PXE.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0112_Enable-PXE.ps1' to exist, but it did not exist.
[-] 0112_Enable-PXE Tests.Parameter Validation.should accept Config parameter 79ms (71ms|7ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0112_Enable-PXE.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0112_Enable-PXE.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0112_Enable-PXE.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0112_Enable-PXE.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[-] 0113_Config-DNS Tests.Script Structure Validation.should have valid PowerShell syntax 18ms (15ms|3ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0113_Config-DNS.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0113_Config-DNS.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0113_Config-DNS.ps1' to exist, but it did not exist.
[-] 0113_Config-DNS Tests.Parameter Validation.should accept Config parameter 37ms (32ms|5ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0113_Config-DNS.Tests.ps1:36
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0113_Config-DNS.Tests.ps1:36
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0113_Config-DNS.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0113_Config-DNS.Tests.ps1:36 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[32m[+] /workspaces/opentofu-lab-automation/tests/0114_Config-TrustedHosts.Tests.ps1[0m[90m 91ms (2ms|68ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0114_Config-TrustedHosts.Tests.ps1[0m[90m 91ms (2ms|68ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0200_Get-SystemInfo.Tests.ps1[0m[90m 100ms (3ms|60ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0200_Get-SystemInfo.Tests.ps1[0m[90m 100ms (3ms|60ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0201_Install-NodeCore.Tests.ps1[0m[90m 101ms (3ms|58ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0201_Install-NodeCore.Tests.ps1[0m[90m 101ms (3ms|58ms)[0m
[-] 0202_Install-NodeGlobalPackages Tests.Script Structure Validation.should have valid PowerShell syntax 20ms (16ms|4ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0202_Install-NodeGlobalPackages.ps1' to exist, but it did not exist.
[-] 0202_Install-NodeGlobalPackages Tests.Script Structure Validation.should define expected functions 204ms (200ms|4ms)
 at Get-Command 'Install-GlobalPackage' -ErrorAction SilentlyContinue | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:34
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:34
 Expected a value, but got $null or empty.
[-] 0202_Install-NodeGlobalPackages Tests.Parameter Validation.should accept Config parameter 29ms (28ms|1ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:41
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0202_Install-NodeGlobalPackages.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:41 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:68:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  68 | [0m             [36;1mGet-Command 'Install-GlobalPackage'[0m | Should -Not -BeNull â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-GlobalPackage' is not recognized as a name of a[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mcmdlet, function, script file, or executable program. Check the spelling[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mof the name, or if a path was included, verify that the path is correct[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mand try again.[0m
[-] 0202_Install-NodeGlobalPackages Tests.Install-GlobalPackage Function Tests.should be defined and accessible 367ms (363ms|4ms)
 at Get-Command 'Install-GlobalPackage' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:68
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:68
 Expected a value, but got $null or empty.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:71:14[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  71 | [0m             ([36;1mGet-Command 'Install-GlobalPackage'[0m).Parameters.Keys | S â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-GlobalPackage' is not recognized as a name of a[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mcmdlet, function, script file, or executable program. Check the spelling[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mof the name, or if a path was included, verify that the path is correct[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mand try again.[0m
[-] 0202_Install-NodeGlobalPackages Tests.Install-GlobalPackage Function Tests.should support common parameters 104ms (103ms|1ms)
 at (Get-Command 'Install-GlobalPackage').Parameters.Keys | Should -Contain 'Verbose', /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:71
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:71
 Expected 'Verbose' to be found in collection @($null), but it was not found.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:82:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  82 | [0m             [36;1mGet-Command 'Install-NodeGlobalPackages'[0m | Should -Not -B â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-NodeGlobalPackages' is not recognized as a name of a[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mcmdlet, function, script file, or executable program. Check the spelling[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mof the name, or if a path was included, verify that the path is correct[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mand try again.[0m
[-] 0202_Install-NodeGlobalPackages Tests.Install-NodeGlobalPackages Function Tests.should be defined and accessible 81ms (80ms|1ms)
 at Get-Command 'Install-NodeGlobalPackages' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:82
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:82
 Expected a value, but got $null or empty.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:85:14[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  85 | [0m             ([36;1mGet-Command 'Install-NodeGlobalPackages'[0m).Parameters.Key â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-NodeGlobalPackages' is not recognized as a name of a[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mcmdlet, function, script file, or executable program. Check the spelling[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mof the name, or if a path was included, verify that the path is correct[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mand try again.[0m
[-] 0202_Install-NodeGlobalPackages Tests.Install-NodeGlobalPackages Function Tests.should support common parameters 99ms (98ms|1ms)
 at (Get-Command 'Install-NodeGlobalPackages').Parameters.Keys | Should -Contain 'Verbose', /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:85
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0202_Install-NodeGlobalPackages.Tests.ps1:85
 Expected 'Verbose' to be found in collection @($null), but it was not found.
[-] 0203_Install-npm Tests.Script Structure Validation.should have valid PowerShell syntax 5ms (4ms|1ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0203_Install-npm.ps1' to exist, but it did not exist.
[-] 0203_Install-npm Tests.Script Structure Validation.should define expected functions 79ms (78ms|1ms)
 at Get-Command 'Install-NpmDependencies' -ErrorAction SilentlyContinue | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:34
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:34
 Expected a value, but got $null or empty.
[-] 0203_Install-npm Tests.Parameter Validation.should accept Config parameter 9ms (8ms|1ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:40
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:40
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0203_Install-npm.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:40 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:67:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  67 | [0m             [36;1mGet-Command 'Install-NpmDependencies'[0m | Should -Not -BeNu â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-NpmDependencies' is not recognized as a name of a[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mcmdlet, function, script file, or executable program. Check the spelling[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mof the name, or if a path was included, verify that the path is correct[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mand try again.[0m
[-] 0203_Install-npm Tests.Install-NpmDependencies Function Tests.should be defined and accessible 116ms (115ms|1ms)
 at Get-Command 'Install-NpmDependencies' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:67
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:67
 Expected a value, but got $null or empty.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:70:14[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  70 | [0m             ([36;1mGet-Command 'Install-NpmDependencies'[0m).Parameters.Keys | â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-NpmDependencies' is not recognized as a name of a[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mcmdlet, function, script file, or executable program. Check the spelling[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mof the name, or if a path was included, verify that the path is correct[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mand try again.[0m
[-] 0203_Install-npm Tests.Install-NpmDependencies Function Tests.should support common parameters 220ms (218ms|2ms)
 at (Get-Command 'Install-NpmDependencies').Parameters.Keys | Should -Contain 'Verbose', /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:70
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0203_Install-npm.Tests.ps1:70
 Expected 'Verbose' to be found in collection @($null), but it was not found.
[-] 0204_Install-Poetry Tests.Script Structure Validation.should have valid PowerShell syntax 9ms (8ms|1ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0204_Install-Poetry.ps1' to exist, but it did not exist.
[-] 0204_Install-Poetry Tests.Script Structure Validation.should define expected functions 179ms (177ms|1ms)
 at Get-Command 'Install-Poetry' -ErrorAction SilentlyContinue | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:34
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:34
 Expected a value, but got $null or empty.
[-] 0204_Install-Poetry Tests.Parameter Validation.should accept Config parameter 12ms (11ms|1ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:40
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:40
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0204_Install-Poetry.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:40 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:67:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  67 | [0m             [36;1mGet-Command 'Install-Poetry'[0m | Should -Not -BeNullOrEmpty[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-Poetry' is not recognized as a name of a cmdlet,[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfunction, script file, or executable program. Check the spelling of the[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mname, or if a path was included, verify that the path is correct and try[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1magain.[0m
[-] 0204_Install-Poetry Tests.Install-Poetry Function Tests.should be defined and accessible 115ms (114ms|1ms)
 at Get-Command 'Install-Poetry' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:67
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:67
 Expected a value, but got $null or empty.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:70:14[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  70 | [0m             ([36;1mGet-Command 'Install-Poetry'[0m).Parameters.Keys | Should - â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Install-Poetry' is not recognized as a name of a cmdlet,[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfunction, script file, or executable program. Check the spelling of the[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mname, or if a path was included, verify that the path is correct and try[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1magain.[0m
[-] 0204_Install-Poetry Tests.Install-Poetry Function Tests.should support common parameters 169ms (168ms|1ms)
 at (Get-Command 'Install-Poetry').Parameters.Keys | Should -Contain 'Verbose', /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:70
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0204_Install-Poetry.Tests.ps1:70
 Expected 'Verbose' to be found in collection @($null), but it was not found.
[32m[+] /workspaces/opentofu-lab-automation/tests/0205_Install-Sysinternals.Tests.ps1[0m[90m 98ms (2ms|30ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0205_Install-Sysinternals.Tests.ps1[0m[90m 98ms (2ms|30ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0206_Install-Python.Tests.ps1[0m[90m 217ms (3ms|58ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0206_Install-Python.Tests.ps1[0m[90m 217ms (3ms|58ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0207_Install-Git.Tests.ps1[0m[90m 138ms (4ms|82ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0207_Install-Git.Tests.ps1[0m[90m 138ms (4ms|82ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0208_Install-DockerDesktop.Tests.ps1[0m[90m 103ms (3ms|66ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0208_Install-DockerDesktop.Tests.ps1[0m[90m 103ms (3ms|66ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0209_Install-7Zip.Tests.ps1[0m[90m 103ms (4ms|65ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0209_Install-7Zip.Tests.ps1[0m[90m 103ms (4ms|65ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0210_Install-VSCode.Tests.ps1[0m[90m 175ms (3ms|137ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0210_Install-VSCode.Tests.ps1[0m[90m 175ms (3ms|137ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0211_Install-VSBuildTools.Tests.ps1[0m[90m 120ms (4ms|85ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0211_Install-VSBuildTools.Tests.ps1[0m[90m 120ms (4ms|85ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0212_Install-AzureCLI.Tests.ps1[0m[90m 138ms (8ms|100ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0212_Install-AzureCLI.Tests.ps1[0m[90m 138ms (8ms|100ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0213_Install-AWSCLI.Tests.ps1[0m[90m 166ms (3ms|119ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0213_Install-AWSCLI.Tests.ps1[0m[90m 166ms (3ms|119ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0214_Install-Packer.Tests.ps1[0m[90m 294ms (16ms|241ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0214_Install-Packer.Tests.ps1[0m[90m 294ms (16ms|241ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/0215_Install-Chocolatey.Tests.ps1[0m[90m 185ms (3ms|139ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/0215_Install-Chocolatey.Tests.ps1[0m[90m 185ms (3ms|139ms)[0m
[-] 0216_Set-LabProfile Tests.Script Structure Validation.should have valid PowerShell syntax 7ms (6ms|1ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0216_Set-LabProfile.ps1' to exist, but it did not exist.
[-] 0216_Set-LabProfile Tests.Script Structure Validation.should define expected functions 77ms (76ms|1ms)
 at Get-Command 'Set-LabProfile' -ErrorAction SilentlyContinue | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:34
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:34
 Expected a value, but got $null or empty.
[-] 0216_Set-LabProfile Tests.Parameter Validation.should accept Config parameter 8ms (7ms|1ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:40
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:40
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/runner_scripts/0216_Set-LabProfile.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:40 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:46:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  46 | [0m             [36;1mGet-Command 'Set-LabProfile'[0m | Should -Not -BeNullOrEmpty[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Set-LabProfile' is not recognized as a name of a cmdlet,[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfunction, script file, or executable program. Check the spelling of the[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mname, or if a path was included, verify that the path is correct and try[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1magain.[0m
[-] 0216_Set-LabProfile Tests.Set-LabProfile Function Tests.should be defined and accessible 93ms (92ms|1ms)
 at Get-Command 'Set-LabProfile' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:46
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:46
 Expected a value, but got $null or empty.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:49:14[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  49 | [0m             ([36;1mGet-Command 'Set-LabProfile'[0m).Parameters.Keys | Should - â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Set-LabProfile' is not recognized as a name of a cmdlet,[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfunction, script file, or executable program. Check the spelling of the[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mname, or if a path was included, verify that the path is correct and try[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1magain.[0m
[-] 0216_Set-LabProfile Tests.Set-LabProfile Function Tests.should support common parameters 83ms (82ms|2ms)
 at (Get-Command 'Set-LabProfile').Parameters.Keys | Should -Contain 'Verbose', /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:49
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/0216_Set-LabProfile.Tests.ps1:49
 Expected 'Verbose' to be found in collection @($null), but it was not found.
[32m[+] /workspaces/opentofu-lab-automation/tests/9999_Reset-Machine.Tests.ps1[0m[90m 65ms (1ms|20ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/9999_Reset-Machine.Tests.ps1[0m[90m 65ms (1ms|20ms)[0m
[-] Cleanup-Files script.removes repo and infra directories when they exist 60ms (59ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:67
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Cleanup-Files script.handles missing directories gracefully 59ms (58ms|1ms)
 at { . $script:scriptPath -Config $config } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:85
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:85
 Expected no exception to be thrown, but an exception "The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~.
[-] Cleanup-Files script.runs without a global log file 63ms (62ms|1ms)
 at { . $script:scriptPath -Config $config } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:98
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:98
 Expected no exception to be thrown, but an exception "The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~.
[-] Cleanup-Files script.completes when LogFilePath is undefined 108ms (107ms|1ms)
 at { . $script:scriptPath -Config $config } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:115
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:115
 Expected no exception to be thrown, but an exception "The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~.
[-] Cleanup-Files script.completes when the repo directory is removed 68ms (67ms|1ms)
 at { . $script:scriptPath -Config $config } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:138
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:138
 Expected no exception to be thrown, but an exception "The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~.
[-] Cleanup-Files script.throws when repo removal fails 317ms (316ms|1ms)
 at { & $script:scriptPath -Config $config } | Should -Throw '*Cleanup failed:*', /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:163
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Cleanup-Files.Tests.ps1:163
 Expected an exception with message like '*Cleanup failed:*' to be thrown, but the message was 'The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.'. from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~
[32m[+] /workspaces/opentofu-lab-automation/tests/Config-DNS.Tests.ps1[0m[90m 76ms (1ms|56ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Config-DNS.Tests.ps1[0m[90m 76ms (1ms|56ms)[0m
[-] 0114_Config-TrustedHosts.calls Start-Process with winrm arguments using config value 199ms (197ms|2ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0114_Config-TrustedHosts.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Config-TrustedHosts.Tests.ps1:15
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[32m[+] /workspaces/opentofu-lab-automation/tests/Configure-Firewall.Tests.ps1[0m[90m 29ms (1ms|13ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Configure-Firewall.Tests.ps1[0m[90m 29ms (1ms|13ms)[0m
[-] Customize-ISO.ps1.honours parameters and logs each step 53ms (52ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Customize-ISO.Tests.ps1:34
 CommandNotFoundException: The term 'New-CimInstance' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] CustomLint.ps1.parses without errors 11ms (10ms|1ms)
 at ($errs ? $errs.Count : 0) | Should -Be 0, /workspaces/opentofu-lab-automation/tests/CustomLint.Tests.ps1:11
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/CustomLint.Tests.ps1:11
 Expected 0, but got 1.
[-] CustomLint.ps1.returns exit code 1 when analyzer reports errors 38ms (37ms|1ms)
 
 CommandNotFoundException: Could not find Command Invoke-ScriptAnalyzer
[-] CustomLint.ps1.fails when Invoke-WebRequest mock lacks ParameterFilter 37ms (35ms|1ms)
 
 CommandNotFoundException: Could not find Command Invoke-ScriptAnalyzer
[-] CustomLint.ps1.returns exit code 0 when no errors 37ms (36ms|1ms)
 
 CommandNotFoundException: Could not find Command Invoke-ScriptAnalyzer
[-] Invoke-ArchiveDownload.uses gh CLI when -UseGh 54ms (53ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Download-Archive.Tests.ps1:14
 CommandNotFoundException: The term 'Invoke-ArchiveDownload' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Invoke-ArchiveDownload.uses Invoke-WebRequest when -UseGh not specified 105ms (103ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Download-Archive.Tests.ps1:20
 CommandNotFoundException: The term 'Invoke-ArchiveDownload' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[32m[+] /workspaces/opentofu-lab-automation/tests/Enable-PXE.Tests.ps1[0m[90m 24ms (1ms|11ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Enable-PXE.Tests.ps1[0m[90m 24ms (1ms|11ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/Enable-RemoteDesktop.Tests.ps1[0m[90m 34ms (1ms|15ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Enable-RemoteDesktop.Tests.ps1[0m[90m 34ms (1ms|15ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/Enable-WinRM.Tests.ps1[0m[90m 33ms (1ms|15ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Enable-WinRM.Tests.ps1[0m[90m 33ms (1ms|15ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/EscapePathArgument.Tests.ps1[0m[90m 125ms (84ms|24ms)[0m
[-] Expand-All.expands a specific ZIP file when provided 111ms (110ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Expand-All.Tests.ps1:25
 CommandNotFoundException: The term 'Expand-All' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[31;1mPop-Location: [0m/workspaces/opentofu-lab-automation/tests/Expand-All.Tests.ps1:56:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  56 | [0m             [36;1mPop-Location[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1m'/tmp/3368da98-7094-41a5-a63b-d3ce15c1a470/b0dca7a9-463b-4fa3-9d7b-37d97ef7d7ec/opentofu-lab-automation' because it does not exist.[0m
[-] Expand-All.expands all ZIP files recursively when no path is given 62ms (61ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Expand-All.Tests.ps1:54
 CommandNotFoundException: The term 'Expand-All' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Expand-All.logs message when specified ZIP file does not exist 187ms (186ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Expand-All.Tests.ps1:71
 CommandNotFoundException: The term 'Expand-All' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Expand-All.cancels when user declines expansion 253ms (252ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Expand-All.Tests.ps1:89
 CommandNotFoundException: The term 'Expand-All' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Format-Config.formats config as indented JSON 28ms (28ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:9
 CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Format-Config.accepts pipeline input 40ms (39ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:16
 CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Format-Config.accepts pipeline input by property name 40ms (39ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:23
 CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Format-Config.throws when no Config is provided 60ms (58ms|1ms)
 at $_.Exception | Should -BeOfType [System.ArgumentException], /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:32
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:32
 Expected the value to have type [System.ArgumentException] or any of its subtypes, but got System.Management.Automation.CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
    at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) with type [System.Management.Automation.CommandNotFoundException].
[-] Format-Config.throws when pipeline is empty 34ms (33ms|1ms)
 at $_.Exception | Should -BeOfType [System.ArgumentException], /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:41
 Expected the value to have type [System.ArgumentException] or any of its subtypes, but got System.Management.Automation.CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
    at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) with type [System.Management.Automation.CommandNotFoundException].
[-] Format-Config.throws when Config is null 31ms (30ms|1ms)
 at $_.Exception | Should -BeOfType [System.ArgumentException], /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:50
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:50
 Expected the value to have type [System.ArgumentException] or any of its subtypes, but got System.Management.Automation.CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
    at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) with type [System.Management.Automation.CommandNotFoundException].
[-] Format-Config.is a terminating error when Config is null 33ms (32ms|1ms)
 at $_.Exception | Should -BeOfType [System.ArgumentException], /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:59
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:59
 Expected the value to have type [System.ArgumentException] or any of its subtypes, but got System.Management.Automation.CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
    at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) with type [System.Management.Automation.CommandNotFoundException].
[-] Format-Config.is a terminating error when piped null 32ms (31ms|1ms)
 at $_.Exception | Should -BeOfType [System.ArgumentException], /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:68
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Format-Config.Tests.ps1:68
 Expected the value to have type [System.ArgumentException] or any of its subtypes, but got System.Management.Automation.CommandNotFoundException: The term 'Format-Config' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
    at System.Management.Automation.ExceptionHandlingOps.CheckActionPreference(FunctionContext funcContext, Exception exception)
    at System.Management.Automation.Interpreter.ActionCallInstruction`2.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame)
    at System.Management.Automation.Interpreter.EnterTryCatchFinallyInstruction.Run(InterpretedFrame frame) with type [System.Management.Automation.CommandNotFoundException].
[-] Get-HyperVProviderVersion.uses version from config 119ms (118ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0010_Prepare-HyperVProvider.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Get-HyperVProviderVersion.Tests.ps1:7
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Get-HyperVProviderVersion.falls back to default when not specified 318ms (314ms|5ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0010_Prepare-HyperVProvider.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Get-HyperVProviderVersion.Tests.ps1:14
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[32m[+] /workspaces/opentofu-lab-automation/tests/Get-LabConfig.Tests.ps1[0m[90m 143ms (87ms|21ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/Get-Platform.Tests.ps1[0m[90m 35ms (7ms|11ms)[0m
[-] 0200_Get-SystemInfo.runs without throwing and returns expected keys 58ms (57ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0200_Get-SystemInfo.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Get-SystemInfo.Tests.ps1:15
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[31;1mPop-Location: [0m/workspaces/opentofu-lab-automation/tests/Get-SystemInfo.Tests.ps1:58:9[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  58 | [0m         [36;1mPop-Location[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m         ~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mCannot find path[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1m'/tmp/115bf465-125b-4bed-9b2e-6bc67c430094/2302e5f1-c18d-4a67-92bb-b44b7a30b1f7' because it does not exist.[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/Hypervisor.Tests.ps1[0m[90m 38ms (8ms|11ms)[0m
[-] Initialize-OpenTofu script.clones repo when InfraRepoUrl is provided 72ms (71ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:39
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Initialize-OpenTofu script.pulls updates when repo already exists 63ms (63ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:69
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Initialize-OpenTofu script.runs tofu init in InfraRepoPath 69ms (69ms|0ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:101
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Initialize-OpenTofu script.installs OpenTofu when tofu command is missing 71ms (70ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:137
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] Initialize-OpenTofu script.throws when installation does not make tofu available 63ms (62ms|0ms)
 at { & $script:ScriptPath -Config $config } | Should -Throw '*Tofu still not found after installation*', /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:168
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:168
 Expected an exception with message like '*Tofu still not found after installation*' to be thrown, but the message was 'The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.'. from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~
[-] Initialize-OpenTofu script.errors when Install-OpenTofu script is missing 63ms (62ms|0ms)
 at Should -Throw '*installer*', /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:197
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Initialize-OpenTofu.Tests.ps1:196
 Expected an exception with message like '*installer*' to be thrown, but the message was 'The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.'. from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~
[32m[+] /workspaces/opentofu-lab-automation/tests/Install-CA.Tests.ps1[0m[90m 95ms (0ms|12ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Install-CA.Tests.ps1[0m[90m 95ms (0ms|12ms)[0m
[-] 0007_Install-Go.installs Go when enabled 82ms (82ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0007_Install-Go.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Install-Go.Tests.ps1:23
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] 0007_Install-Go.skips when InstallGo is false 53ms (52ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0007_Install-Go.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Install-Go.Tests.ps1:33
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] 0007_Install-Go.does nothing when Go is already installed 54ms (54ms|0ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0007_Install-Go.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Install-Go.Tests.ps1:44
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [INFO] Running npm install in /tmp/2653e0aa-b74d-458e-8a8f-8e1857959545 ...
[2025-06-12 02:02:39] [INFO] npm install completed.
[2025-06-12 02:02:39] [INFO] ==== Frontend dependency installation complete ====
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [INFO] Running npm install in /tmp/e239b55b-ef7d-4e60-9a3b-bf6f9b9f90d9 ...
[2025-06-12 02:02:39] [INFO] npm install completed.
[2025-06-12 02:02:39] [INFO] ==== Frontend dependency installation complete ====
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [ERROR] ERROR: Frontend folder not found at: /tmp/c6e383aa-b118-4736-944d-ec63ea8a8ead
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [ERROR] ERROR: Frontend folder not found at: /workspaces/opentofu-lab-automation/pwsh/runner_scripts/../frontend
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Completed 0203_Install-npm.ps1
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [INFO] Creating missing frontend folder at: /tmp/0001b37b-2300-490f-b0ae-24587bd3485e
[2025-06-12 02:02:39] [INFO] Running npm install in /tmp/0001b37b-2300-490f-b0ae-24587bd3485e ...
[2025-06-12 02:02:39] [INFO] npm install completed.
[2025-06-12 02:02:39] [INFO] ==== Frontend dependency installation complete ====
[32m[+] /workspaces/opentofu-lab-automation/tests/Install-npm.Tests.ps1[0m[90m 260ms (224ms|12ms)[0m
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [INFO] Executing Poetry installer...
[2025-06-12 02:02:39] [INFO] Completed 
[2025-06-12 02:02:39] [INFO] Completed 0204_Install-Poetry.ps1
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [INFO] InstallPoetry flag is disabled. Skipping Poetry installation.
[2025-06-12 02:02:39] [INFO] Completed 
[2025-06-12 02:02:39] [INFO] Completed 0204_Install-Poetry.ps1
[2025-06-12 02:02:39] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:39] [INFO] Running 
[2025-06-12 02:02:39] [INFO] Downloading https://install.python-poetry.org to /tmp/install-poetry_6286a3fb-fb1d-4f4a-84e5-869b2b8c963d.py
[2025-06-12 02:02:39] [INFO] Executing Poetry installer...
[2025-06-12 02:02:39] [ERROR] ERROR: Python executable not found. Ensure Python is installed and in PATH.
[32m[+] /workspaces/opentofu-lab-automation/tests/Install-Poetry.Tests.ps1[0m[90m 551ms (515ms|15ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/Install-Sysinternals.Tests.ps1[0m[90m 40ms (0ms|12ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Install-Sysinternals.Tests.ps1[0m[90m 40ms (0ms|12ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/Install-ValidationTools.Tests.ps1[0m[90m 51ms (0ms|11ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Install-ValidationTools.Tests.ps1[0m[90m 51ms (0ms|11ms)[0m
[-] Invoke-LabDownload.downloads and executes action with cleanup 3ms (2ms|1ms)
 
 RuntimeException: No modules named 'LabRunner' are currently loaded.
[91m[-] /workspaces/opentofu-lab-automation/tests/InvokeOpenTofuInstaller.Tests.ps1 failed with:[0m
[91mCommandNotFoundException: The term 'Get-Platform' is not recognized as a name of a cmdlet, function, script file, or executable program.
[91mCheck the spelling of the name, or if a path was included, verify that the path is correct and try again.
[91mat global:Get-TestConfiguration, /workspaces/opentofu-lab-automation/tests/helpers/TestHelpers.ps1:407
[91mat <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/InvokeOpenTofuInstaller.Tests.ps1:13[0m
[TEST DEBUG] repoRoot: /workspaces/opentofu-lab-automation/tests/..
[TEST DEBUG] runnerScriptName: pwsh/runner.ps1
[TEST DEBUG] runnerScriptPath: /workspaces/opentofu-lab-automation/tests/../pwsh/runner.ps1
[-] kicker-bootstrap syntax validation.does not have problematic variable interpolation patterns 4ms (3ms|0ms)
 at $content | Should -Not -Match '"\s*[^"]*\$\w+:[^"]*"' -Because "Variables followed by colon in strings should be escaped", /workspaces/opentofu-lab-automation/tests/Kicker-Bootstrap.Tests.ps1:113
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Kicker-Bootstrap.Tests.ps1:113
 Expected regular expression '"\s*[^"]*\$\w+:[^"]*"' to not match '<# 
 .SYNOPSIS
   Kicker script for a fresh Windows Server Core setup with robust error handling.
   1) Loads configs/config_files/default-config.json by default (override with -ConfigFile).
   2) Checks if command-line Git is installed and in PATH.
      - Installs a minimal version if missing.
      - Updates PATH if installed but not found in PATH.
   3) Checks if GitHub CLI is installed and in PATH.
      - Installs GitHub CLI if missing.
      - Updates PATH if installed but not found in PATH.
      - Prompts for authentication if not already authenticated.
   4) Clones a repository from config.json -> RepoUrl to config.json -> LocalPath (or a default path).
   5) Invokes runner.ps1 from that repo.
 #>
 param(
     [string]$ConfigFile,
     [switch]$Quiet,
     [ValidateSet('silent','normal','detailed')]
     [string]$Verbosity = 'normal'
 )
 function Get-CrossPlatformTempPath {
     <#
     .SYNOPSIS
     Returns the appropriate temporary directory path for the current platform.
     
     .DESCRIPTION
     Provides a cross-platform way to get the temporary directory, handling cases where
     $env:TEMP might not be set (e.g., on Linux/macOS).
     #>
     if ($env:TEMP) { 
         return $env:TEMP 
     } else { 
         return [System.IO.Path]::GetTempPath() 
     }
 }
 if ($Quiet.IsPresent) { $Verbosity = 'silent' }
 $script:VerbosityLevels = @{ silent = 0; normal = 1; detailed = 2 }
 $script:ConsoleLevel    = $script:VerbosityLevels[$Verbosity]
 $targetBranch = 'main'
 $baseUrl = 'https://raw.githubusercontent.com/wizzense/opentofu-lab-automation/refs/heads/'
 $defaultConfig = "${baseUrl}${targetBranch}/configs/config_files/default-config.json"
 # example: https://raw.githubusercontent.com/wizzense/tofu-base-lab/refs/heads/main/configs/bootstrap-config.json
 $prompt = "`n<press any key to continue>`n"
 function Write-Continue($prompt) {
   [Console]::Write($prompt + '  ')
   Read-LoggedInput -Prompt $prompt | Out-Null
 }
 $ErrorActionPreference = 'Stop'  # So any error throws an exception
 $ProgressPreference = 'SilentlyContinue'
 # Resolve script root even when $PSScriptRoot is not populated (e.g. -Command)
 $scriptRoot = if ($PSScriptRoot) { $PSScriptRoot } else { Split-Path -Parent $MyInvocation.MyCommand.Path }
 $isWindowsOS = [System.Environment]::OSVersion.Platform -eq 'Win32NT'
 # Ensure the logger utility is available even when this script is executed
 # standalone. If the logger script is missing, download it from the repository.
 $loggerDir  = Join-Path (Join-Path $scriptRoot 'lab_utils') 'LabRunner'
 $loggerPath = Join-Path $loggerDir 'Logger.ps1'
 if (-not (Test-Path $loggerPath)) {
     if (-not (Test-Path $loggerDir)) {
         New-Item -ItemType Directory -Path $loggerDir -Force | Out-Null
     }
     $loggerUrl = "${baseUrl}${targetBranch}/pwsh/lab_utils/LabRunner/Logger.ps1"
     Invoke-WebRequest -Uri $loggerUrl -OutFile $loggerPath
 }
 try {
     . $loggerPath
 } catch {
     Write-Error "Failed to load logger script: $_"
     exit 1
 }
 # Set default log file path if none is defined
 if (-not (Get-Variable -Name LogFilePath -Scope Script -ErrorAction SilentlyContinue) -and
     -not (Get-Variable -Name LogFilePath -Scope Global -ErrorAction SilentlyContinue)) {
     $logDir = $env:LAB_LOG_DIR
     if (-not $logDir) {
         if ($isWindowsOS) { $logDir = 'C:\\temp' } else { $logDir = [System.IO.Path]::GetTempPath() }
     }
     if (-not (Test-Path $logDir)) { New-Item -ItemType Directory -Path $logDir -Force | Out-Null }
     $script:LogFilePath = Join-Path $logDir 'lab.log'
 }
 # Fallback inline logger in case dot-sourcing failed
 if (-not (Get-Command Write-CustomLog -ErrorAction SilentlyContinue)) {
     function Write-CustomLog {
         param(
             [string]$Message,
             [ValidateSet('INFO','WARN','ERROR')] [string]$Level = 'INFO'
         )
         $levelIdx = @{ INFO = 1; WARN = 1; ERROR = 0 }[$Level]
         if (-not (Get-Variable -Name LogFilePath -Scope Script -ErrorAction SilentlyContinue)) {
             $logDir = $env:LAB_LOG_DIR
             if (-not $logDir) { $logDir = if ($isWindowsOS) { 'C:\\temp' } else { [System.IO.Path]::GetTempPath() } }
             $script:LogFilePath = Join-Path $logDir 'lab.log'
         }
         if (-not (Get-Variable -Name ConsoleLevel -Scope Script -ErrorAction SilentlyContinue)) {
             $script:ConsoleLevel = 1
         }
         $ts  = Get-Date -Format 'yyyy-MM-dd HH:mm:ss'
         $fmt = "[$ts] [$Level] $Message"
         $fmt | Out-File -FilePath $script:LogFilePath -Encoding utf8 -Append
         if ($levelIdx -le $script:ConsoleLevel) {
             $color = @{ INFO='Gray'; WARN='Yellow'; ERROR='Red' }[$Level]
             Write-Host $fmt -ForegroundColor $color
         }
     }
     function Read-LoggedInput {
         [CmdletBinding()]
         param(
             [Parameter(Mandatory)][string]$Prompt,
             [switch]$AsSecureString
         )
         if ($AsSecureString) {
             Write-CustomLog "$Prompt (secure input)"
             return Read-Host -Prompt $Prompt -AsSecureString
         }
         $answer = Read-Host -Prompt $Prompt
         Write-CustomLog "$($Prompt): $answer"
         return $answer
     }
 }
 # Load config helper
 $labUtilsDir = Join-Path $scriptRoot 'lab_utils'
 $labConfigScript = Join-Path $labUtilsDir 'Get-LabConfig.ps1'
 $formatScript    = Join-Path $labUtilsDir 'Format-Config.ps1'
 if (-not (Test-Path $labConfigScript)) {
     if (-not (Test-Path $labUtilsDir)) {
         New-Item -ItemType Directory -Path $labUtilsDir -Force | Out-Null
     }
     $labConfigUrl = 'https://raw.githubusercontent.com/wizzense/opentofu-lab-automation/main/pwsh/lab_utils/Get-LabConfig.ps1'
     Invoke-WebRequest -Uri $labConfigUrl -OutFile $labConfigScript
 }
 if (-not (Test-Path $formatScript)) {
     if (-not (Test-Path $labUtilsDir)) {
         New-Item -ItemType Directory -Path $labUtilsDir -Force | Out-Null
     }
     $formatUrl = 'https://raw.githubusercontent.com/wizzense/opentofu-lab-automation/main/pwsh/lab_utils/Format-Config.ps1'
     Invoke-WebRequest -Uri $formatUrl -OutFile $formatScript
 }
 . $labConfigScript
 . $formatScript
 # ------------------------------------------------
 # (0) clever? message, take a second...
 # ------------------------------------------------
 Write-CustomLog "`nYo!"
 Write-Continue "`n<press any key to continue>`n"
 Write-CustomLog "Use `-Quiet` to reduce output."
 Write-CustomLog "I know you totally read the readme first, but just in case you didn't...`n"
 Write-CustomLog """
 Note: In order for most of this to work you will actually have to provide a config file. 
 You can either modify this command to point to the remote/local path, or leave it as is. 
 You will have an opportunity after this to actually view the config file and even modify it.
 At the time of this writing that feature may be broken... oh well.
 The script will do the following if you proceed:
   1) Loads configs/config_files/default-config.json by default (override with -ConfigFile).
   2) Checks if command-line Git is installed and in PATH.
      - Installs a minimal version if missing.
      - Updates PATH if installed but not found in PATH.
   3) Checks if GitHub CLI is installed and in PATH.
      - Installs GitHub CLI if missing.
      - Updates PATH if installed but not found in PATH.
      - Prompts for authentication if not already authenticated.
   4) Clones a repository from config.json -> RepoUrl to config.json -> LocalPath (or a default path).
   5) Invokes runner.ps1 from that repo.
 """
 # Prompt for input to provide remote/local or accept default
 $configOption = Read-LoggedInput -Prompt "`nEnter a remote URL or local path, or leave blank for default."
 if ($configOption -match "https://") {
     Invoke-WebRequest -Uri $configOption -OutFile '.\custom-config.json'
     $ConfigFile = (Join-Path $scriptRoot "custom-config.json")
 } elseif ($configOption -and (Test-Path -Path $configOption)) {
     $ConfigFile = $configOption
 } else {
     $localConfigDir = Join-Path (Join-Path $scriptRoot "configs") "config_files"
     if (!(Test-Path $localConfigDir)) {
         New-Item -ItemType Directory -Path $localConfigDir | Out-Null
     }
     $configFiles = Get-ChildItem -Path $localConfigDir -Filter '*.json' -File
     if ($configFiles.Count -gt 1) {
         Write-CustomLog "Multiple configuration files found:" "INFO"
         for ($i = 0; $i -lt $configFiles.Count; $i++) {
             $num = $i + 1
             Write-CustomLog ("{0}) {1}" -f $num, $configFiles[$i].Name) "INFO" | Write-Host
         }
         $ans = Read-LoggedInput -Prompt 'Select configuration number'
         if ($ans -match '^[0-9]+$' -and [int]$ans -ge 1 -and [int]$ans -le $configFiles.Count) {
             $ConfigFile = $configFiles[[int]$ans - 1].FullName
         } else {
             $ConfigFile = $configFiles[0].FullName
         }
     } elseif ($configFiles.Count -eq 1) {
         $ConfigFile = $configFiles[0].FullName
     } else {
         $localConfigPath = Join-Path $localConfigDir "default-config.json"
         if (-not (Test-Path $localConfigPath)) {
             Invoke-WebRequest -Uri $defaultConfig -OutFile $localConfigPath
         }
         $ConfigFile = $localConfigPath
     }
 }
 # ------------------------------------------------
 # (1) Load Configuration
 # ------------------------------------------------
 Write-CustomLog "==== Loading configuration file ===="
 try {
     $config = Get-LabConfig -Path $ConfigFile
     Write-CustomLog "Config file loaded from $ConfigFile."
     Write-CustomLog (Format-Config -Config $config)
 } catch {
     Write-Error "ERROR: Failed to load configuration file - $($_.Exception.Message)"
     exit 1
 }
 # ------------------------------------------------
 # (2) Check & Install Git for Windows
 # ------------------------------------------------
 Write-CustomLog "==== Checking if Git is installed ===="
 $gitPath = "C:\Program Files\Git\cmd\git.exe"
 if (Test-Path $gitPath) {
     Write-CustomLog "Git is already installed at: $gitPath"
 } else {
     if ($Config.InstallGit -eq $true) {
         Write-CustomLog "Git is not installed. Downloading and installing Git for Windows..."
         $gitInstallerUrl = "https://github.com/git-for-windows/git/releases/download/v2.48.1.windows.1/Git-2.48.1-64-bit.exe"
         $gitInstallerPath = Join-Path -Path (Get-CrossPlatformTempPath) -ChildPath "GitInstaller.exe"
         Invoke-WebRequest -Uri $gitInstallerUrl -OutFile $gitInstallerPath -UseBasicParsing
         Write-CustomLog "Installing Git silently..."
         Start-Process -FilePath $gitInstallerPath -ArgumentList "/SILENT" -Wait -NoNewWindow
         Remove-Item -Path $gitInstallerPath -ErrorAction SilentlyContinue
         Write-CustomLog "Git installation completed."
     }
 }
 # Double-check Git
 try {
     $gitVersion = & "$gitPath" --version
     Write-CustomLog $gitVersion
     Write-CustomLog "Git is installed and working."
 } catch {
     Write-Error "ERROR: Git installation failed or is not accessible. Exiting."
     exit 1
 }
 # ------------------------------------------------
 # (2.5) Ensure PowerShell 7 is present
 # ------------------------------------------------
 $isWindowsOS = [System.Environment]::OSVersion.Platform -eq 'Win32NT'
 if (-not $isWindowsOS) {
     Write-Error "PowerShell 7 installation via this script is only supported on Windows."
     exit 1
 }
 Write-CustomLog "==== Checking if PowerShell 7 is installed ===="
 $pwshPath = "C:\\Program Files\\PowerShell\\7\\pwsh.exe"
 if (!(Test-Path $pwshPath)) {
     if ($Config.InstallPwsh -eq $true) {
         $pwshInstallerUrl = "https://github.com/PowerShell/PowerShell/releases/latest/download/PowerShell-7.5.1-win-x64.msi"
         $pwshInstallerPath = Join-Path -Path (Get-CrossPlatformTempPath) -ChildPath "PowerShellInstaller.msi"
         Invoke-WebRequest -Uri $pwshInstallerUrl -OutFile $pwshInstallerPath -UseBasicParsing
         Write-CustomLog "Installing PowerShell 7 silently..."
         Start-Process msiexec.exe -ArgumentList "/i `"$pwshInstallerPath`" /quiet /norestart" -Wait -Verb RunAs
         Remove-Item -Path $pwshInstallerPath -ErrorAction SilentlyContinue
         Write-CustomLog "PowerShell 7 installation completed."
     } else {
         Write-Error "PowerShell 7 is required. Set InstallPwsh=true in the config."
         exit 1
     }
 }
 if (!(Test-Path $pwshPath)) {
     Write-Error "ERROR: PowerShell 7 installation failed or is not accessible."
     exit 1
 }
 # ------------------------------------------------
 # (3) Check GitHub CLI and call by explicit path
 # ------------------------------------------------
 Write-CustomLog "==== Checking if GitHub CLI is installed ===="
 $ghExePath = "C:\Program Files\GitHub CLI\gh.exe"
 if (!(Test-Path $ghExePath)) {
     if ($Config.InstallGitHubCLI -eq $true) {
         Write-CustomLog "GitHub CLI not found. Downloading from $($config.GitHubCLIInstallerUrl)..."
         $ghCliInstaller = Join-Path -Path (Get-CrossPlatformTempPath) -ChildPath "GitHubCLIInstaller.msi"
         Invoke-WebRequest -Uri $config.GitHubCLIInstallerUrl -OutFile $ghCliInstaller -UseBasicParsing
         Write-CustomLog "Installing GitHub CLI silently..."
         Start-Process msiexec.exe -ArgumentList "/i `"$ghCliInstaller`" /quiet /norestart /log `"$(Get-CrossPlatformTempPath)\ghCliInstall.log`"" -Wait -Verb RunAs
         Remove-Item -Path $ghCliInstaller -ErrorAction SilentlyContinue
         Write-CustomLog "GitHub CLI installation completed."
     }
 } else {
     Write-CustomLog "GitHub CLI found at '$ghExePath'."
 }
 if (!(Test-Path $ghExePath)) {
     Write-Error "ERROR: gh.exe not found at '$ghExePath'. Installation may have failed."
     exit 1
 }
 # ------------------------------------------------
 # (3.5) Check & Prompt for GitHub CLI Authentication
 # ------------------------------------------------
 Write-CustomLog "==== Checking GitHub CLI Authentication ===="
 try {
     # If not authenticated, 'gh auth status' returns non-zero exit code
     & "$ghExePath" auth status 2>&1
     Write-CustomLog "GitHub CLI is authenticated."
 }
 catch {
     Write-CustomLog "GitHub CLI is not authenticated."
     # Optional: Prompt user for a personal access token
     $pat = Read-LoggedInput -Prompt "Enter your GitHub Personal Access Token (or press Enter to skip):"
     if (-not [string]::IsNullOrWhiteSpace($pat)) {
         Write-CustomLog "Attempting PAT-based GitHub CLI login..."
         try {
             $pat | & "$ghExePath" auth login --hostname github.com --git-protocol https --with-token
         }
         catch {
             Write-Error "ERROR: PAT-based login failed. Please verify your token or try interactive login."
             exit 1
         }
     }
     else {
         # No PAT, attempt normal interactive login in the console
         Write-CustomLog "No PAT provided. Attempting interactive login..."
         try {
             & "$ghExePath" auth login --hostname github.com --git-protocol https
         }
         catch {
             Write-Error "ERROR: Interactive login failed: $($_.Exception.Message)"
             exit 1
         }
     }
     # After the login attempt, re-check auth
     try {
         & "$ghExePath" auth status 2>&1
         Write-CustomLog "GitHub CLI is now authenticated."
     }
     catch {
         Write-Error "ERROR: GitHub authentication failed. Please run '$ghExePath auth login' manually and re-run."
         exit 1
     }
 }
 # ------------------------------------------------
 # Helper to update repo while preserving local config changes
 function Update-RepoPreserveConfig {
     param(
         [string]$RepoPath,
         [string]$Branch,
         [string]$GitPath
     )
     Push-Location $RepoPath
     $configChanges = & $GitPath status --porcelain "configs/config_files" 2>$null
     $backupDir = $null
     if ($configChanges -and (Test-Path 'configs/config_files')) {
         $backupDir = Join-Path $RepoPath 'config_backup'
         Write-CustomLog "Backing up local config changes to $backupDir" 'INFO'
         if (Test-Path $backupDir) { Remove-Item -Recurse -Force $backupDir }
         Copy-Item -Path 'configs/config_files' -Destination $backupDir -Recurse -Force
         & $GitPath stash push -u -- 'configs/config_files' | Out-Null
     }
     & $GitPath pull origin $Branch --quiet 2>&1 >> "$(Get-CrossPlatformTempPath)\git.log"
     if ($configChanges -and (Test-Path $backupDir)) {
         Write-CustomLog 'Restoring backed up config files' 'INFO'
         Copy-Item -Path (Join-Path $backupDir '*') -Destination 'configs/config_files' -Recurse -Force
         Remove-Item -Recurse -Force $backupDir -ErrorAction SilentlyContinue
         & $GitPath stash drop --quiet | Out-Null
     }
     Pop-Location
 }
 # ------------------------------------------------
 # (4) Clone or Update Repository (using explicit Git/gh)
 # ------------------------------------------------
 Write-CustomLog "==== Cloning or updating the target repository ===="
 try {
     & "$ghExePath" auth status 2>&1 | Out-Null
 } catch {
     Write-Error "GitHub CLI is not authenticated. Please run '$ghExePath auth login' and re-run this script."
     exit 1
 }
 if (-not $config.RepoUrl) {
     Write-Error "ERROR: config.json does not specify 'RepoUrl'."
     exit 1
 }
 # Define local path (fallback if not in config)
 $localPath = $config.LocalPath
 $localPath = if (-not $localPath -or [string]::IsNullOrWhiteSpace($localPath)) {
     if ($isWindowsOS) {
         Get-CrossPlatformTempPath
     } else {
         [System.IO.Path]::GetTempPath()
     }
 } else {
     $localPath
 }
 $localPath = [System.Environment]::ExpandEnvironmentVariables($localPath)
 # Ensure local directory exists
 Write-CustomLog "Ensuring local path '$localPath' exists..."
 if (!(Test-Path $localPath)) {
     New-Item -ItemType Directory -Path $localPath -Force | Out-Null
 }
 # Define repo path
 $repoName = ($config.RepoUrl -split '/')[-1] -replace "\.git$", ""
 $repoPath = Join-Path $localPath $repoName
 if (-not $repoPath) {
     Write-Error "ERROR: Repository path could not be determined. Check config.json and retry."
     exit 1
 }
 # Configure git safe.directory to avoid dubious ownership errors
 # Use GetFullPath so path need not exist yet
 $resolvedRepoPath = [System.IO.Path]::GetFullPath($repoPath)
 & "$gitPath" config --global --add safe.directory $resolvedRepoPath 2>$null
 if (!(Test-Path $repoPath)) {
     Write-CustomLog "Cloning repository from $($config.RepoUrl) to $repoPath..."
     $prevEAP = $ErrorActionPreference
     $ErrorActionPreference = 'Continue'
     & "$ghExePath" repo clone $config.RepoUrl $repoPath -- -q 2>&1 | Tee-Object -FilePath "$(Get-CrossPlatformTempPath)\gh_clone_log.txt"
     $ghExit = $LASTEXITCODE
     $ErrorActionPreference = $prevEAP
     if ($ghExit -ne 0 -or !(Test-Path $repoPath)) {
         Write-CustomLog "GitHub CLI clone failed or directory not created. Trying git clone..."
         
         # Remove existing directory if it exists and is empty/problematic
         if (Test-Path $repoPath) {
             try {
                 Remove-Item -Path $repoPath -Recurse -Force -ErrorAction SilentlyContinue
                 Write-CustomLog "Removed existing problematic directory: $repoPath"
             } catch {
                 Write-CustomLog "Warning: Could not remove existing directory: $repoPath"
             }
         }
         
         & "$gitPath" clone $config.RepoUrl $repoPath --quiet 2>&1 | Tee-Object -FilePath "$(Get-CrossPlatformTempPath)\git_clone_log.txt"
         $gitExit = $LASTEXITCODE
         
         # Handle Windows-specific checkout failures due to invalid filenames
         if ($gitExit -ne 0 -and $isWindowsOS -and (Test-Path $repoPath)) {
             Write-CustomLog "Git clone failed, likely due to Windows filename restrictions. Attempting recovery..."
             Push-Location $repoPath
             try {
                 # Restore files that can be checked out on Windows
                 & "$gitPath" restore --source=HEAD :/ 2>&1 | Out-Null
                 Write-CustomLog "Attempted file restoration. Repository may be partially functional."
                 $gitExit = 0  # Consider this a success for Windows
             } catch {
                 Write-CustomLog "File restoration failed: $_"
             } finally {
                 Pop-Location
             }
         }
         
         if ($gitExit -ne 0 -or !(Test-Path $repoPath)) {
             Write-Error "ERROR: Repository cloning failed. Check logs: $(Get-CrossPlatformTempPath)\gh_clone_log.txt and $(Get-CrossPlatformTempPath)\git_clone_log.txt"
             if (Test-Path "$(Get-CrossPlatformTempPath)\gh_clone_log.txt") {
                 Write-Host '--- gh_clone_log.txt ---' -ForegroundColor Yellow
                 Get-Content "$(Get-CrossPlatformTempPath)\gh_clone_log.txt" | Out-Host
             }
             if (Test-Path "$(Get-CrossPlatformTempPath)\git_clone_log.txt") {
                 Write-Host '--- git_clone_log.txt ---' -ForegroundColor Yellow
                 Get-Content "$(Get-CrossPlatformTempPath)\git_clone_log.txt" | Out-Host
             }
             exit 1
         }
     }
 }
 # Immediately check directory contents after clone
 if ((Get-ChildItem -Path $repoPath -Recurse -ErrorAction SilentlyContinue | Measure-Object).Count -eq 0) {
     Write-Error "ERROR: Repo directory $repoPath is empty after clone. Check clone logs above."
     if (Test-Path "$(Get-CrossPlatformTempPath)\gh_clone_log.txt") {
         Write-Host '--- gh_clone_log.txt ---' -ForegroundColor Yellow
         Get-Content "$(Get-CrossPlatformTempPath)\gh_clone_log.txt" | Out-Host
     }
     if (Test-Path "$(Get-CrossPlatformTempPath)\git_clone_log.txt") {
         Write-Host '--- git_clone_log.txt ---' -ForegroundColor Yellow
         Get-Content "$(Get-CrossPlatformTempPath)\git_clone_log.txt" | Out-Host
     }
     exit 1
 }
 # Ensure the desired branch is checked out and up to date
 Push-Location $repoPath
 & "$gitPath" fetch --all --quiet 2>&1 >> "$env:TEMP\git.log"
 # Avoid noisy checkout messages when already on the target branch
 $currentBranch = (& "$gitPath" rev-parse --abbrev-ref HEAD).Trim()
 $checkoutCode = 0
 if ($currentBranch -ne $targetBranch) {
     $prevEAP = $ErrorActionPreference
     $ErrorActionPreference = 'Continue'
     $null = & "$gitPath" checkout $targetBranch 2>&1
     $checkoutCode = $LASTEXITCODE
     $ErrorActionPreference = $prevEAP
 }
 if ($checkoutCode -ne 0) {
     Write-Warning "Branch '$targetBranch' not found. Using current branch."
 } else {
     & "$gitPath" pull origin $targetBranch --quiet 2>&1 >> "$env:TEMP\git.log"
 }
 Pop-Location
 # ------------------------------------------------
 # (5) Invoke the Runner Script
 # ------------------------------------------------
 Write-CustomLog "==== Invoking the runner script ===="
 $runnerScriptName = $config.RunnerScriptName
 if (-not $runnerScriptName) {
     Write-Warning "No runner script specified in config. Exiting gracefully."
     exit 0
 }
 Set-Location $repoPath
 # Robust path resolution for runner script
 if ([System.IO.Path]::IsPathRooted($runnerScriptName)) {
     $runnerScriptPath = $runnerScriptName
 } else {
     $runnerScriptPath = Join-Path $repoPath $runnerScriptName
 }
 Write-Host "[DEBUG] ConfigFile: $ConfigFile" -ForegroundColor Cyan
 Write-Host "[DEBUG] repoPath: $repoPath" -ForegroundColor Cyan
 Write-Host "[DEBUG] runnerScriptName: $runnerScriptName" -ForegroundColor Cyan
 Write-Host "[DEBUG] runnerScriptPath: $runnerScriptPath" -ForegroundColor Cyan
 Write-Host "[DEBUG] Directory contents of repoPath (${repoPath}):" -ForegroundColor Cyan
 Get-ChildItem -Path $repoPath -Recurse | Select-Object FullName
 if (!(Test-Path $runnerScriptPath)) {
     Write-Error "ERROR: Could not find runner script at $runnerScriptPath. Exiting."
     Write-Host "[DEBUG] Directory contents of repoPath (${repoPath}):" -ForegroundColor Yellow
     Get-ChildItem -Path $repoPath -Recurse | Format-List FullName | Out-Host
     Write-Host @"
 Possible causes:
 - The repository clone failed or is incomplete.
 - The repository does not contain $runnerScriptName at its root or subdirectory.
 - The wrong branch or an empty repo was cloned.
 - Config file RunnerScriptName is incorrect: $runnerScriptName
 Next steps:
 - Check the output above for missing files.
 - Verify your config.RepoUrl is correct and points to a valid repository.
 - Try deleting ${repoPath} and rerunning this script.
 "@ -ForegroundColor Yellow
     exit 1
 }
 Write-CustomLog "Running $runnerScriptPath ..."
 $args = @('-NoLogo','-NoProfile','-File', $runnerScriptPath, '-ConfigFile', $ConfigFile, '-Verbosity', $Verbosity)
 $proc = Start-Process -FilePath $pwshPath -ArgumentList $args -Wait -NoNewWindow -PassThru
 $exitCode = $proc.ExitCode
 if ($exitCode -ne 0) {
     Write-CustomLog "Runner script failed with exit code $exitCode"
     exit $exitCode
 }
 Write-CustomLog "`n=== Kicker script finished successfully! ==="
 exit 0
 ', because Variables followed by colon in strings should be escaped, but it did match.
[32m[+] /workspaces/opentofu-lab-automation/tests/kicker-bootstrap.Tests.ps1[0m[90m 88ms (2ms|33ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/kicker-bootstrap.Tests.ps1[0m[90m 88ms (2ms|33ms)[0m
[32m[+] /workspaces/opentofu-lab-automation/tests/Kickstart-Bootstrap.Tests.ps1[0m[90m 31ms (4ms|13ms)[0m
[2025-06-12 02:02:40] [INFO] test message
[2025-06-12 02:02:40] [INFO] another test
[2025-06-12 02:02:40] [INFO] hello world
[2025-06-12 02:02:40] [INFO] variable default works
[32m[+] /workspaces/opentofu-lab-automation/tests/Logger.Tests.ps1[0m[90m 84ms (46ms|21ms)[0m
[-] Get-MenuSelection.returns all items when user types all.returns all items 9ms (8ms|1ms)
 at $sel | Should -Be $items, /workspaces/opentofu-lab-automation/tests/Menu.Tests.ps1:16
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Menu.Tests.ps1:16
 Expected @('0001_Test.ps1', '0002_Other.ps1'), but got $null.
[-] Get-MenuSelection.returns item by prefix.returns item by prefix 5ms (4ms|0ms)
 at $sel | Should -Be @('0002_Other.ps1'), /workspaces/opentofu-lab-automation/tests/Menu.Tests.ps1:25
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Menu.Tests.ps1:25
 Expected '0002_Other.ps1', but got $null.
[91m[-] /workspaces/opentofu-lab-automation/tests/Network.Tests.ps1 failed with:[0m
[91mCommandNotFoundException: The term 'Get-Platform' is not recognized as a name of a cmdlet, function, script file, or executable program.
[91mCheck the spelling of the name, or if a path was included, verify that the path is correct and try again.
[91mat global:Get-TestConfiguration, /workspaces/opentofu-lab-automation/tests/helpers/TestHelpers.ps1:407
[91mat <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Network.Tests.ps1:13[0m
[91m[-] Describe Node installation scripts failed[0m
[91m CommandNotFoundException: Could not find Command Read-LoggedInput[0m
[-] Normalize-RelativePath.joins mixed separators into platform path 5ms (4ms|0ms)
 at Normalize-RelativePath, /workspaces/opentofu-lab-automation/pwsh/lab_utils/PathUtils.ps1:10
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/PathUtils.Tests.ps1:11
 ParameterBindingValidationException: Cannot bind argument to parameter 'Path' because it is null.
[-] Normalize-RelativePath.handles trailing separators 2ms (2ms|0ms)
 at Normalize-RelativePath, /workspaces/opentofu-lab-automation/pwsh/lab_utils/PathUtils.ps1:10
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/PathUtils.Tests.ps1:17
 ParameterBindingValidationException: Cannot bind argument to parameter 'Path' because it is null.
[32m[+] /workspaces/opentofu-lab-automation/tests/Reset-Machine.Tests.ps1[0m[90m 23ms (0ms|8ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/Reset-Machine.Tests.ps1[0m[90m 23ms (0ms|8ms)[0m
[-] Resolve-ProjectPath.resolves path from path-index.yaml 9ms (8ms|1ms)
 at Normalize-RelativePath, /workspaces/opentofu-lab-automation/pwsh/lab_utils/PathUtils.ps1:10
 at Resolve-ProjectPath, /workspaces/opentofu-lab-automation/pwsh/lab_utils/Resolve-ProjectPath.ps1:27
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Resolve-ProjectPath.Tests.ps1:32
 ParameterBindingValidationException: Cannot bind argument to parameter 'Path' because it is null.
[-] Resolve-ProjectPath.resolves direct index entry with normalized separators 7ms (6ms|1ms)
 at Normalize-RelativePath, /workspaces/opentofu-lab-automation/pwsh/lab_utils/PathUtils.ps1:10
 at Resolve-ProjectPath, /workspaces/opentofu-lab-automation/pwsh/lab_utils/Resolve-ProjectPath.ps1:22
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Resolve-ProjectPath.Tests.ps1:44
 ParameterBindingValidationException: Cannot bind argument to parameter 'Path' because it is null.
[-] runner.ps1 script selection.runs non-interactively when -Scripts is supplied 24ms (23ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/ad3f6248-48ad-42be-973f-320af843114a/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:101
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/ad3f6248-48ad-42be-973f-320af843114a/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.uses pwsh from PSHOME when not in PATH 13ms (13ms|0ms)
 
 CommandNotFoundException: Could not find Command Read-LoggedInput
[-] runner.ps1 script selection.relaunches under pwsh when invoked from PowerShell 5 31ms (31ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/93516ffe-ba61-4b32-9d21-de7aed4f52cc/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:155
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/93516ffe-ba61-4b32-9d21-de7aed4f52cc/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.exits with code 1 when -Scripts has no matching prefixes 21ms (21ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/6a5642f8-7690-44a2-adc1-643ca6d52543/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:169
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/6a5642f8-7690-44a2-adc1-643ca6d52543/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.continues executing all scripts even if one fails 36ms (35ms|0ms)
 
 CommandNotFoundException: Could not find Command Read-LoggedInput
[-] runner.ps1 script selection.continues executing all scripts when one throws 80ms (80ms|0ms)
 
 CommandNotFoundException: Could not find Command Read-LoggedInput
[-] runner.ps1 script selection.runs only cleanup script when 0000 is combined with others in Auto mode 54ms (53ms|1ms)
 
 CommandNotFoundException: Could not find Command Read-LoggedInput
[-] runner.ps1 script selection.forces script execution when flag disabled using -Force 57ms (57ms|1ms)
 
 CommandNotFoundException: Could not find Command Read-LoggedInput
[-] runner.ps1 script selection.skips script action when flag disabled and -Force not used 113ms (112ms|1ms)
 
 CommandNotFoundException: Could not find Command Read-LoggedInput
[-] runner.ps1 script selection.reports success when script omits an exit statement 48ms (48ms|1ms)
 
 CommandNotFoundException: Could not find Command Read-LoggedInput
[-] runner.ps1 script selection.suppresses informational logs when -Verbosity silent is used 19ms (19ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/d78b5ddc-af08-4cf5-b1df-76eec97bdefb/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:357
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/d78b5ddc-af08-4cf5-b1df-76eec97bdefb/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.suppresses informational logs when -Quiet is used 17ms (16ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/71d55692-02ff-49e7-9658-3842d9ae3dd1/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:383
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/71d55692-02ff-49e7-9658-3842d9ae3dd1/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.suppresses informational logs when -Verbosity silent is used 17ms (16ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/d867f95a-ad83-4377-9175-fe0ed74ff88e/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:409
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/d867f95a-ad83-4377-9175-fe0ed74ff88e/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.prompts twice when -Auto is used without -Scripts 20ms (19ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/8143cd71-3e31-4869-848d-ae5090c5105b/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:431
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/8143cd71-3e31-4869-848d-ae5090c5105b/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.handles empty or invalid selection by logging and doing nothing 23ms (22ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/20b9f756-e40c-447a-8f83-eaf2e05388c6/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:452
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/20b9f756-e40c-447a-8f83-eaf2e05388c6/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] runner.ps1 script selection.logs script output exactly once 21ms (21ms|0ms)
 at <ScriptBlock>, /tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/e4990357-71e5-405e-9b42-2d2231cb39fe/pwsh/runner.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:473
 CommandNotFoundException: The term '/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/e4990357-71e5-405e-9b42-2d2231cb39fe/pwsh/lab_utils/PathUtils.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[31;1mCopy-Item: [0m/workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:486:9[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 486 | [0m         [36;1mCopy-Item (Join-Path $PSScriptRoot '..' 'pwsh' 'lab_utils') -[0m â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mAn item with the specified name[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1m/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/37b1cd98-9d36-44b5-bf7b-89434145af5e/lab_utils already exists.[0m
[31;1mCopy-Item: [0m/workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:486:9[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m 486 | [0m         [36;1mCopy-Item (Join-Path $PSScriptRoot '..' 'pwsh' 'lab_utils') -[0m â€¦[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mAn item with the specified name[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1m/tmp/e02735e1-51de-4f69-b24e-2bbde550f1ce/37b1cd98-9d36-44b5-bf7b-89434145af5e/lab_utils/LabRunner already exists.[0m
[-] runner.ps1 script selection.pipes Get-SystemInfo output to the caller 235ms (235ms|0ms)
 at $text | Should -Match 'ComputerName', /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:495
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Runner.Tests.ps1:495
 Expected regular expression 'ComputerName' to match 'The argument './runner.ps1' is not recognized as the name of a script file. Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
 Usage: pwsh[.exe] [-Login] [[-File] <filePath> [args]]
                   [-Command { - | <script-block> [-args <arg-array>]
                                 | <string> [<CommandParameters>] } ]
                   [-CommandWithArgs <string> [<CommandParameters>]
                   [-ConfigurationName <string>] [-ConfigurationFile <filePath>]
                   [-CustomPipeName <string>] [-EncodedCommand <Base64EncodedCommand>]
                   [-ExecutionPolicy <ExecutionPolicy>] [-InputFormat {Text | XML}]
                   [-Interactive] [-MTA] [-NoExit] [-NoLogo] [-NonInteractive] [-NoProfile]
                   [-NoProfileLoadTime] [-OutputFormat {Text | XML}] 
                   [-SettingsFile <filePath>] [-SSHServerMode] [-STA] 
                   [-Version] [-WindowStyle <style>] 
                   [-WorkingDirectory <directoryPath>]
        pwsh[.exe] -h | -Help | -? | /?
 PowerShell Online Help https://aka.ms/powershell-docs
 All parameters are case-insensitive.', but it did not match.
[32m[+] /workspaces/opentofu-lab-automation/tests/runner.Tests.ps1[0m[90m 183ms (6ms|100ms)[0m
[93m[!] /workspaces/opentofu-lab-automation/tests/runner.Tests.ps1[0m[90m 183ms (6ms|100ms)[0m
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 13ms (13ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0001_Reset-Git.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 8ms (7ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0002_Setup-Directories.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 8ms (7ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0006_Install-ValidationTools.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 9ms (7ms|2ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0007_Install-Go.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 9ms (8ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 9ms (8ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0100_Enable-WinRM.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 6ms (6ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0101_Enable-RemoteDesktop.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 7ms (6ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0102_Configure-Firewall.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 6ms (5ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0103_Change-ComputerName.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 6ms (6ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0105_Install-HyperV.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 6ms (5ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0106_Install-WAC.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 6ms (6ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0111_Disable-TCPIP6.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 6ms (5ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0112_Enable-PXE.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 6ms (5ms|1ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0113_Config-DNS.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 4ms (3ms|0ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
No Config parameter found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0114_Config-TrustedHosts.ps1
[-] Runner scripts parameter and command checks.declares a Config parameter when required 4ms (3ms|0ms)
 at $configParam.Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:41
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0000_Cleanup-Files.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 14ms (13ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0001_Reset-Git.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 10ms (9ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0002_Setup-Directories.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (7ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0006_Install-ValidationTools.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 10ms (8ms|2ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0007_Install-Go.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 8ms (7ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0008_Install-OpenTofu.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 14ms (13ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0009_Initialize-OpenTofu.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 10ms (9ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0010_Prepare-HyperVProvider.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 11ms (10ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0100_Enable-WinRM.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 4ms (4ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0101_Enable-RemoteDesktop.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 5ms (4ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0102_Configure-Firewall.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 6ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0103_Change-ComputerName.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0104_Install-CA.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 10ms (8ms|2ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0105_Install-HyperV.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 9ms (8ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0106_Install-WAC.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 6ms (5ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0111_Disable-TCPIP6.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 5ms (4ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0112_Enable-PXE.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 11ms (10ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0113_Config-DNS.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0114_Config-TrustedHosts.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0200_Get-SystemInfo.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 10ms (9ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0201_Install-NodeCore.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0202_Install-NodeGlobalPackages.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 8ms (7ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0203_Install-npm.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 9ms (8ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0204_Install-Poetry.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0205_Install-Sysinternals.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0206_Install-Python.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0207_Install-Git.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0208_Install-DockerDesktop.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 6ms (5ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0209_Install-7Zip.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 5ms (4ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0210_Install-VSCode.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 10ms (8ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0211_Install-VSBuildTools.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 8ms (7ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0212_Install-AzureCLI.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 4ms (4ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0213_Install-AWSCLI.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 6ms (5ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0214_Install-Packer.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 7ms (6ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0215_Install-Chocolatey.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 6ms (5ms|1ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0216_Set-LabProfile.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 4ms (4ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
Command 'Import-Module "$PSScriptRoot/../lab_utils/LabRunner/LabRunner.psd1"' not found in /workspaces/opentofu-lab-automation/pwsh/runner_scripts/9999_Reset-Machine.ps1
[-] Runner scripts parameter and command checks.contains mandatory command invocations 4ms (4ms|0ms)
 at ($found | Measure-Object).Count | Should -BeGreaterThan 0, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:53
 Expected the actual value to be greater than 0, but got 0.
[-] Runner scripts parameter and command checks.resolves PSScriptRoot when run with pwsh -File 658ms (658ms|1ms)
 at $result.Trim() | Should -Be $expected, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:107
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/RunnerScripts.Tests.ps1:107
 Expected '/tmp/318d02f0-36c8-49ae-8596-bb957c10e432', but got @('[31;1m=: [0m/tmp/318d02f0-36c8-49ae-8596-bb957c10e432/dummy.ps1:2:2[0m', '[31;1m[0m[36;1mLine |[0m', '[31;1m[0m[36;1m[36;1m   2 | [0m  [36;1m=[0m '0'[0m', '[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m  ~[0m', '[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term '=' is not recognized as a name of a cmdlet, function, script[0m', '[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfile, or executable program. Check the spelling of the name, or if a[0m', '[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mpath was included, verify that the path is correct and try again.[0m', '[31;1mImport-Module: [0m/tmp/318d02f0-36c8-49ae-8596-bb957c10e432/dummy.ps1:3:1[0m', '[31;1m[0m[36;1mLine |[0m', '[31;1m[0m[36;1m[36;1m   3 | [0m [36;1mImport-Module LabRunner[0m', ...11 more).
[-] ScriptTemplate Tests.Script Structure Validation.should have valid PowerShell syntax 2ms (2ms|0ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/Modules/LabRunner/ScriptTemplate.ps1' to exist, but it did not exist.
[-] ScriptTemplate Tests.Parameter Validation.should accept Body parameter 5ms (5ms|0ms)
 at { & $scriptPath -Body 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:40
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:40
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/Modules/LabRunner/ScriptTemplate.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:40 char:17
     +             { & $scriptPath -Body 'TestValue' -WhatIf } | Should -Not â€¦
     +                 ~~~~~~~~~~~.
[-] ScriptTemplate Tests.Parameter Validation.should accept Config parameter 5ms (5ms|0ms)
 at { & $scriptPath -Config 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:43
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:43
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/Modules/LabRunner/ScriptTemplate.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/ScriptTemplate.Tests.ps1:43 char:17
     +             { & $scriptPath -Config 'TestValue' -WhatIf } | Should -N â€¦
     +                 ~~~~~~~~~~~.
[2025-06-12 02:02:43] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:43] [INFO] Running 
[2025-06-12 02:02:43] [INFO] Profile written to /home/codespace/.config/powershell/profile.ps1
[2025-06-12 02:02:43] [INFO] Completed Set-LabProfile
[2025-06-12 02:02:43] [INFO] Completed 0216_Set-LabProfile.ps1
[2025-06-12 02:02:43] [INFO] Starting System.Management.Automation.InvocationInfo.MyCommand
[2025-06-12 02:02:43] [INFO] Running 
[2025-06-12 02:02:43] [INFO] SetupLabProfile flag is disabled. Skipping profile creation.
[2025-06-12 02:02:43] [INFO] Completed Set-LabProfile
[2025-06-12 02:02:43] [INFO] Completed 0216_Set-LabProfile.ps1
[32m[+] /workspaces/opentofu-lab-automation/tests/Set-LabProfile.Tests.ps1[0m[90m 96ms (70ms|11ms)[0m
[-] 0002_Setup-Directories.creates directories when the script runs 142ms (141ms|1ms)
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0002_Setup-Directories.ps1:2
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Setup-Directories.Tests.ps1:23
 CommandNotFoundException: The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
[-] 0002_Setup-Directories.handles existing directories gracefully 163ms (162ms|1ms)
 at { & $script:ScriptPath -Config $cfg } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/Setup-Directories.Tests.ps1:34
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/Setup-Directories.Tests.ps1:34
 Expected no exception to be thrown, but an exception "The term 'Param' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/pwsh/runner_scripts/0002_Setup-Directories.ps1:2 char:1
     + Param([object]$Config)
     + ~~~~~.
[-] setup-test-env Tests.Script Structure Validation.should have valid PowerShell syntax 13ms (13ms|1ms)
 at $scriptPath | Should -Exist, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:24
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:24
 Expected path '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/setup-test-env.ps1' to exist, but it did not exist.
[-] setup-test-env Tests.Script Structure Validation.should define expected functions 251ms (250ms|1ms)
 at Get-Command 'Ensure-Pester' -ErrorAction SilentlyContinue | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:34
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:34
 Expected a value, but got $null or empty.
[-] setup-test-env Tests.Parameter Validation.should accept UsePoetry parameter 14ms (14ms|1ms)
 at { & $scriptPath -UsePoetry 'TestValue' -WhatIf } | Should -Not -Throw, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:42
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:42
 Expected no exception to be thrown, but an exception "The term '/workspaces/opentofu-lab-automation/tests/../workspaces/opentofu-lab-automation/pwsh/setup-test-env.ps1' is not recognized as a name of a cmdlet, function, script file, or executable program.
 Check the spelling of the name, or if a path was included, verify that the path is correct and try again." was thrown from /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:42 char:17
     +             { & $scriptPath -UsePoetry 'TestValue' -WhatIf } | Should â€¦
     +                 ~~~~~~~~~~~.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:69:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  69 | [0m             [36;1mGet-Command 'Ensure-Pester'[0m | Should -Not -BeNullOrEmpty[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Ensure-Pester' is not recognized as a name of a cmdlet,[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfunction, script file, or executable program. Check the spelling of the[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mname, or if a path was included, verify that the path is correct and try[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1magain.[0m
[-] setup-test-env Tests.Ensure-Pester Function Tests.should be defined and accessible 112ms (111ms|1ms)
 at Get-Command 'Ensure-Pester' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:69
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:69
 Expected a value, but got $null or empty.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:79:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  79 | [0m             [36;1mGet-Command 'Ensure-Python'[0m | Should -Not -BeNullOrEmpty[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Ensure-Python' is not recognized as a name of a cmdlet,[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfunction, script file, or executable program. Check the spelling of the[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mname, or if a path was included, verify that the path is correct and try[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1magain.[0m
[-] setup-test-env Tests.Ensure-Python Function Tests.should be defined and accessible 145ms (145ms|1ms)
 at Get-Command 'Ensure-Python' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:79
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:79
 Expected a value, but got $null or empty.
[31;1mGet-Command: [0m/workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:89:13[0m
[31;1m[0m[36;1mLine |[0m
[31;1m[0m[36;1m[36;1m  89 | [0m             [36;1mGet-Command 'Ensure-Poetry'[0m | Should -Not -BeNullOrEmpty[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m     | [31;1m             ~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m     | [31;1mThe term 'Ensure-Poetry' is not recognized as a name of a cmdlet,[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mfunction, script file, or executable program. Check the spelling of the[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1mname, or if a path was included, verify that the path is correct and try[0m
[31;1m[0m[36;1m[36;1m[0m[36;1m[0m[36;1m[31;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m[31;1m[36;1m     | [31;1magain.[0m
[-] setup-test-env Tests.Ensure-Poetry Function Tests.should be defined and accessible 72ms (71ms|1ms)
 at Get-Command 'Ensure-Poetry' | Should -Not -BeNullOrEmpty, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:89
 at <ScriptBlock>, /workspaces/opentofu-lab-automation/tests/setup-test-env.Tests.ps1:89
 Expected a value, but got $null or empty.
[97mTests completed in 26.19s[0m
[97mTests Passed: 227, [0m[91mFailed: 197, [0m[93mSkipped: 274, [0m[90mInconclusive: 0, [0m[37m[0m[90mNotRun: 0[0m
[91mBeforeAll \ AfterAll failed: 1[0m
[91m  - Node installation scripts[0m
[91mContainer failed: 4[0m
[91m  - /workspaces/opentofu-lab-automation/tests/Get-WindowsJobArtifacts.Tests.ps1
[91m  - /workspaces/opentofu-lab-automation/tests/InvokeOpenTofuInstaller.Tests.ps1
[91m  - /workspaces/opentofu-lab-automation/tests/Network.Tests.ps1
[91m  - /workspaces/opentofu-lab-automation/tests/examples/Install-Go.Modern.Tests.ps1[0m
